<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script src="http://code.jquery.com/ui/1.8.21/jquery-ui.min.js"></script>
<!--    <script src="scheduleDataJsonCompact.js"></script> -->
    <script src="first-personas.js"></script> 
     <!--    <script src="personas.js"></script> -->
    <!--<script src="cobi.js"></script> -->
    <script src="backend.js"></script>

    <style>
      td {
      width: 150px;
      }
    </style>
	
     <script language="javascript" type="text/javascript">     

     $(document).ready(function() {
      
      initialize();
      
      // test: changing session data
      //      unscheduleSession(allSessions["209"]);
      //      scheduleSession(allSessions["209"], "May 9, 2012", "16:30", "Ballroom G", "17:50");

      // test: swapping leveraging the crowd with madness
      //       swapSessions(schedule["May 7, 2012"]["11:30"]["Ballroom F"]["117"],
      //           schedule["May 10, 2012"]["08:30"]["Ballroom D"]["223"]);
      //		     alert(JSON.stringify(schedule["May 7, 2012"]["11:30"]["Ballroom F"]));
//      		     alert(JSON.stringify(schedule["May 10, 2012"]["08:30"]["Ballroom D"]));
      


	     //	     alert(randomizeSchedule());
	     //	     alert(JSON.stringify(allSessions["209"]));

	     // test: check that violated constraints are per time and per session associated
             //alert(JSON.stringify(conflictsByTime["May 8, 2012"]["11:30"]));
	     //alert(JSON.stringify(conflictsBySession["153"]));
     		     
	     // test: swapping leveraging the crowd with madness
	     // swapSessions(schedule["May 7, 2012"]["11:30"]["Ballroom F"]["117"],
	     //				  schedule["May 10, 2012"]["08:30"]["Ballroom D"]["223"]);
	     //		     alert(JSON.stringify(schedule["May 7, 2012"]["11:30"]["Ballroom F"]));
	     //		     alert(JSON.stringify(schedule["May 10, 2012"]["08:30"]["Ballroom D"]));
	     
	     
	     // 	     allRooms = getAllRooms();
// 	     allSessions = getAllSessions();
// 	     attachPersonas();  // loads personas from a file into schedule JSON
// 	     initializeAuthorConflictsAmongSessions(); // this can be loaded from a file
// 	     initializePersonaConflictsAmongSessions(); // this can be loaded from a file
// 	     conflictsByTime = getAllConflicts();



	     // test: checking that personas got attached to sessions and print out full persona names
	     //for(var s in schedule["May 7, 2012"]["11:30"]["Ballroom F"]){
	     //	 alert(JSON.stringify(keys(allSessions[s]["personas"]).map(function(x) {return personaHash[x]})));
	     //     }

	     // test: find all sesions with conflicts
	     // 	     for(var s1 in allSessions){
	     // 		 for(var s2 in allSessions){
	     // 		     if(authorConflictsAmongSessions[s1][s2].length > 0){
	     // 			 alert(JSON.stringify(authorConflictsAmongSessions[s1][s2]));
	     // 			 return;
	     // 		     }
	     // 		 }
	     // 	     }
	     // test: checking author conflict finding
	     //	alert(JSON.stringify(computeAuthorConflicts(allSessions["117"], allSessions["47"])));
	     //	     	alert(JSON.stringify(computePersonaConflicts(allSessions["117"], allSessions["47"])));
	     
	     

	     // test: how many conflicts are caused by a session
	     //alert(calculateNumConflictsCausedBy(allSessions["39"]));
	     
     // test: Proposing a swap
     //	     alert(JSON.stringify(proposeSwap(allSessions["39"])));
     	//     alert(JSON.stringify(proposeSwapValues(allSessions["39"])));
	     //	     var swapValues = proposeSwap(allSessions["39"]);
	     //	     var sortedSwaps = keys(swapValues).sort(function(a, b) {return swapValues[b].value- swapValues[a].value;});
	     // 	     // return top 10 swaps
	     //      	     var output = "Finding good swaps for session 39 (" + allSessions["39"].title + ")\n";
	     //	     for(var i = 0; i < 10; i++){
	     //		 output += sortedSwaps[i] + " (" + allSessions[sortedSwaps[i]].title + "): " + swapValues[sortedSwaps[i]].value + "\n";
	     // }
	     //	      	     alert(output);
	     
	     
	     var sm = makeProgram();
	     displayProgram(sm);
	 });

</script>
    </head>
<body>
<button onclick="createDatabase()">Create database entries</button>
<button onclick="sendJSON()">Fill database entries</button>
<button onclick="loadSchedule()">Load database entries</button>
<div id="program"></div>
</body>
</html>
